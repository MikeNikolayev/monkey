---
title: "PowerShell Exploiter"
draft: false
description: "Exploits PowerShell Remoting"
tags: ["exploiter", "powershell", "brute force"]
pre: "<i class='fa fa-terminal'></i> "
---

## PowerShell Remoting

[PowerShell Remoting](
https://docs.microsoft.com/en-us/powershell/scripting/learn/remoting/winrmsecurity)
is a PowerShell feature that enables connecting to Windows machines remotely in
order to run arbitrary commands. It is commonly used by administrators to
manage multiple systems in a network.

## Exploitation

Machines with PowerShell Remoting enabled may be accessible to attackers if
they come across the correct credentials.

Infection Monkey's PowerShell exploiter uses brute-force to attempt to
propagate to a victim through PowerShell Remoting.

![PowerShell Configuration](
/images/island/configuration-page/powershell-exploiter-configuration.png
"PowerShell Configuration")

### Credentials used

The PowerShell exploiter can be run from both Linux and Windows attackers. On
Windows attackers, the exploiter has the ability to use the cached username
and/or password from the current user. On both Linux and Windows attackers, the
exploiter uses all combinations of the [user-configured usernames and
passwords](/usage/configuration/credentials), as well as LM or NT hashes that
have been collected. Different combinations of
credentials are attempted in the following order:

1. **Cached username and password (Windows attacker only)** - The exploiter
   will use the stored credentials of the current user to attempt to log into
   the victim machine.

1. **Brute force usernames with blank passwords** - Windows allows you to
   configure a user with a blank/empty password. The exploiter will attempt to
   log into the victim machine using each username set in the
   [configuration](/usage/configuration/credentials) with a
   blank password.

   In order for the attacker to connect with a blank password, the victim must
   have enabled basic authentication, http and no encryption.

1. **Brute force usernames with cached password (Windows attacker only)** - The
   exploiter will attempt to log into the victim machine using each username
   set in the [configuration](/usage/configuration/credentials) and the current
   user's cached password.

1. **Brute force usernames and passwords** - The exploiter will attempt to use
   all combinations of usernames and passwords that were set in the
   [configuration.](/usage/configuration/credentials)

1. **Brute force usernames and LM hashes** - The exploiter will attempt to use
   all combinations of usernames that were set in the
   [configuration](/usage/configuration/credentials) and LM hashes that were
   collected from any other victims.

1. **Brute force usernames and NT hashes** - The exploiter will attempt to use
   all combinations of usernames that were set in the
   [configuration](/usage/configuration/credentials) and NT hashes that were
   collected from any other victims.

## Mitigation

1. Restrict PowerShell remote command execution and/or harden the credentials
of relevant users.

More information about how to remediate security concerns related to PowerShell
Remoting can be found [here](
https://docs.microsoft.com/en-us/powershell/scripting/learn/remoting/winrmsecurity).

## See also
- [PowerShell exploiter reference documentation](/reference/exploiters/powershell)
